<!DOCTYPE html>
<html lang="en">
	<head>
		<title>C:/Users/Matt</title>
		<meta name="viewport" content="width=800">
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
		<script src="https://rawgit.com/alfg/ping.js/master/dist/ping.min.js"></script>
		<!-- Host setup does NOT like it when links are relative... -->
		<script src="https://www.coley.software/js/terminal.js"></script>
		<script src="https://www.coley.software/js/drag.js"></script>
		<link rel="stylesheet" href="https://www.coley.software/css/wincmd.css">
		<style>
html { 
	background-color: rgb(40, 41, 43);
}
		</style>
	</head>
	<body>	
	</body>
<script>
function getFirstWord(str) {
	let spaceIndex = str.indexOf(' ');
	return spaceIndex === -1 ? str : str.substr(0, spaceIndex);
}
function getLastWord(str) {
	let spaceIndex = str.lastIndexOf(' ');
	return str.substr(spaceIndex + 1);
}
</script>
<script>
var today = new Date();
var hour = today.getHours();
var minute = today.getMinutes();

var hr = hour < 10 ? "0" + hour : hour;
var mn = minute < 10 ? "0" + minute : minute;
var dd = String(today.getDate()).padStart(2, '0');
var mm = String(today.getMonth() + 1).padStart(2, '0');
var yyyy = today.getFullYear();

today = hr + ":" + mn + " - " + mm + '/' + dd + '/' + yyyy;


var s = new System();
var t = new Terminal(s);
var terminal = new TerminalWindow("index", t);
document.body.appendChild(terminal.window);
dragElement(terminal.window)
terminal.setMinWidth = "420px";
terminal.setTitle = "C:\\Windows\\system32\\cmd.exe";
terminal.setIcon("css/assets/cmd.svg", '20px', null, '5px');

function init() {
	var today = new Date();
	var hour = today.getHours();
	var minute = today.getMinutes();
	
	var hr = hour < 10 ? "0" + hour : hour;
	var mn = minute < 10 ? "0" + minute : minute;
	var dd = String(today.getDate()).padStart(2, '0');
	var mm = String(today.getMonth() + 1).padStart(2, '0');
	var yyyy = today.getFullYear();
	
	today = hr + ":" + mn + " - " + mm + '/' + dd + '/' + yyyy;

	terminal.print    ("██╗███╗   ██╗██████╗ ███████╗██╗  ██╗");
	terminal.print    ("██║████╗  ██║██╔══██╗██╔════╝╚██╗██╔╝");
	terminal.print    ("██║██╔██╗ ██║██║  ██║█████╗   ╚███╔╝ ");
	terminal.print    ("██║██║╚██╗██║██║  ██║██╔══╝   ██╔██╗ ");
	terminal.print    ("██║██║ ╚████║██████╔╝███████╗██╔╝ ██╗");
	terminal.print    ("╚═╝╚═╝  ╚═══╝╚═════╝ ╚══════╝╚═╝  ╚═╝");
	terminal.print    (" ");
	terminal.printHtml("<b><u>Logged in as</u>:</b> Matt Coley");
	terminal.printHtml("<b><u>Last login</u>:  </b> " + today);
	terminal.print(" ");
	help();
	terminal.print(" ");
}

function github() {
	terminal.print("Redirecting to github...");
	window.location = 'https://github.com/Col-E';
}

function help() {
	terminal.printHtml("<b><u>Commands</u></b>");
	terminal.printHtml(" ╠═ <b>cls</b>       Clears the console");
	terminal.printHtml(" ╠═ <b>github</b>    Opens the github directory");
	terminal.printHtml(" ╠═ <b>help</b>      Prints recognized commands");
	terminal.printHtml(" ╚═ <b>ping</b>      Ping a domain");
}

var p = new Ping();
function ping(str) {
	var url = getLastWord(str);
	if (url == "ping") {
		terminal.print("Pong!");
		terminal.print(" ");
	} else {
		if (!url.includes("://")) {
			url = "http://" + url;
		}
		p.ping(url, function(err, data) {
			terminal.print("Reply in " + data + "ms");
			if (err) {
				terminal.print("╚═ Error: " + err);
			}
			terminal.print(" ");
		});
	}
}

function loop() {
	terminal.prompt("", function (input) {
		terminal.print(" ");
		var threaded = false;
		switch(getFirstWord(input)) {
		case "clear":
		case "cls":
			terminal.clear();
			break;
		case "github":
			github();
			break;
		case "help":
			help();
			break;
		case "ping":
			threaded = true;
			ping(input);
			break;
		default:
			terminal.print("'" + input + "' is not recognizes as an internal or external command.");
			break;
		}
		if (!threaded) { terminal.print(" "); }
		loop();
	});
}
init();
loop();
</script>
</html>